2025-08-18 15:58:36,173 - __main__ - INFO - Starting surface partition optimization with 1 refinement levels
2025-08-18 15:58:36,173 - __main__ - INFO - ================================================================================
2025-08-18 15:58:36,173 - __main__ - INFO - Refinement Level 1/1
2025-08-18 15:58:36,173 - __main__ - INFO - ================================================================================
2025-08-18 15:58:36,173 - surfaces.ring - INFO - Building ring TriMesh: nr=50, na=50, r_in=0.5, r_out=1.0
2025-08-18 15:58:36,199 - core.tri_mesh - INFO - Starting matrix computation
2025-08-18 15:58:36,860 - core.tri_mesh - INFO - Matrix computation completed: M (2500, 2500), K (2500, 2500)
2025-08-18 15:58:36,862 - core.tri_mesh - INFO - matrix computation completed: 0.663s, memory: 2.03MB
2025-08-18 15:58:36,889 - __main__ - INFO - epsilon set to sqrt(mean_triangle_area) = 2.190e-02
2025-08-18 15:58:36,941 - projection_iterative - INFO - Creating initial condition: 2500x2, method=iterative
2025-08-18 15:58:36,944 - projection_iterative - INFO - Projection converged after 2 iterations
2025-08-18 15:58:36,944 - projection_iterative - INFO - Final errors: row=9.14e-10, area=1.00e-10
2025-08-18 15:58:36,946 - __main__ - INFO - Starting PGD optimization
2025-08-18 15:58:36,952 - __main__ - INFO -   Iteration 0: Energy=3.555919e+01
2025-08-18 15:58:36,952 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:36,952 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,068 - __main__ - INFO -   Iteration 50: Energy=8.714957e-01
2025-08-18 15:58:37,068 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,068 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,175 - __main__ - INFO -   Iteration 100: Energy=8.175308e-01
2025-08-18 15:58:37,175 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,175 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,279 - __main__ - INFO -   Iteration 150: Energy=7.660634e-01
2025-08-18 15:58:37,279 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,279 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,390 - __main__ - INFO -   Iteration 200: Energy=6.966503e-01
2025-08-18 15:58:37,390 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,390 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,495 - __main__ - INFO -   Iteration 250: Energy=6.060443e-01
2025-08-18 15:58:37,495 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,496 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,604 - __main__ - INFO -   Iteration 300: Energy=5.144810e-01
2025-08-18 15:58:37,604 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,604 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,713 - __main__ - INFO -   Iteration 350: Energy=4.362186e-01
2025-08-18 15:58:37,713 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,714 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,821 - __main__ - INFO -   Iteration 400: Energy=3.751991e-01
2025-08-18 15:58:37,821 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,821 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:37,934 - __main__ - INFO -   Iteration 450: Energy=3.331971e-01
2025-08-18 15:58:37,934 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:37,934 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,047 - __main__ - INFO -   Iteration 500: Energy=3.063281e-01
2025-08-18 15:58:38,047 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,047 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,173 - __main__ - INFO -   Iteration 550: Energy=2.835469e-01
2025-08-18 15:58:38,174 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,174 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,349 - __main__ - INFO -   Iteration 600: Energy=2.629151e-01
2025-08-18 15:58:38,349 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,349 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,474 - __main__ - INFO -   Iteration 650: Energy=2.431391e-01
2025-08-18 15:58:38,474 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,474 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,610 - __main__ - INFO -   Iteration 700: Energy=2.256477e-01
2025-08-18 15:58:38,610 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,611 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,765 - __main__ - INFO -   Iteration 750: Energy=2.091627e-01
2025-08-18 15:58:38,765 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,766 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:38,898 - __main__ - INFO -   Iteration 800: Energy=1.946670e-01
2025-08-18 15:58:38,898 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:38,898 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:39,030 - __main__ - INFO -   Iteration 850: Energy=1.824711e-01
2025-08-18 15:58:39,030 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:39,030 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:39,210 - __main__ - INFO -   Iteration 900: Energy=1.748724e-01
2025-08-18 15:58:39,210 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:39,210 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:39,430 - __main__ - INFO -   Iteration 950: Energy=1.705954e-01
2025-08-18 15:58:39,430 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:39,431 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:39,730 - __main__ - INFO -   Iteration 1000: Energy=1.684484e-01
2025-08-18 15:58:39,730 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:39,731 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:40,051 - __main__ - INFO -   Iteration 1050: Energy=1.668484e-01
2025-08-18 15:58:40,051 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:40,052 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:40,392 - __main__ - INFO -   Iteration 1100: Energy=1.659794e-01
2025-08-18 15:58:40,392 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:40,392 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:40,734 - __main__ - INFO -   Iteration 1150: Energy=1.652363e-01
2025-08-18 15:58:40,734 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:40,734 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:41,068 - __main__ - INFO -   Iteration 1200: Energy=1.648574e-01
2025-08-18 15:58:41,068 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:41,068 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:41,398 - __main__ - INFO -   Iteration 1250: Energy=1.646057e-01
2025-08-18 15:58:41,398 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:41,398 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:41,727 - __main__ - INFO -   Iteration 1300: Energy=1.644046e-01
2025-08-18 15:58:41,727 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:41,727 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:42,044 - __main__ - INFO -   Iteration 1350: Energy=1.642260e-01
2025-08-18 15:58:42,044 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:42,044 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:42,375 - __main__ - INFO -   Iteration 1400: Energy=1.640569e-01
2025-08-18 15:58:42,375 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:42,375 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:42,691 - __main__ - INFO -   Iteration 1450: Energy=1.638979e-01
2025-08-18 15:58:42,691 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:42,691 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:43,020 - __main__ - INFO -   Iteration 1500: Energy=1.637468e-01
2025-08-18 15:58:43,020 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:43,020 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:43,344 - __main__ - INFO -   Iteration 1550: Energy=1.636063e-01
2025-08-18 15:58:43,344 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:43,344 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:43,673 - __main__ - INFO -   Iteration 1600: Energy=1.634734e-01
2025-08-18 15:58:43,673 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:43,673 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:43,998 - __main__ - INFO -   Iteration 1650: Energy=1.633492e-01
2025-08-18 15:58:43,998 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:43,998 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:44,334 - __main__ - INFO -   Iteration 1700: Energy=1.632303e-01
2025-08-18 15:58:44,335 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:44,335 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:44,654 - __main__ - INFO -   Iteration 1750: Energy=1.631172e-01
2025-08-18 15:58:44,654 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:44,654 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:44,974 - __main__ - INFO -   Iteration 1800: Energy=1.630065e-01
2025-08-18 15:58:44,974 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:44,974 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:45,299 - __main__ - INFO -   Iteration 1850: Energy=1.628982e-01
2025-08-18 15:58:45,299 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:45,299 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:45,629 - __main__ - INFO -   Iteration 1900: Energy=1.627893e-01
2025-08-18 15:58:45,630 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:45,630 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:45,955 - __main__ - INFO -   Iteration 1950: Energy=1.626794e-01
2025-08-18 15:58:45,955 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:45,956 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:46,289 - __main__ - INFO -   Iteration 2000: Energy=1.625657e-01
2025-08-18 15:58:46,289 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:46,289 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:46,606 - __main__ - INFO -   Iteration 2050: Energy=1.624467e-01
2025-08-18 15:58:46,606 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:46,607 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:46,929 - __main__ - INFO -   Iteration 2100: Energy=1.623507e-01
2025-08-18 15:58:46,929 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:46,929 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:47,259 - __main__ - INFO -   Iteration 2150: Energy=1.621823e-01
2025-08-18 15:58:47,259 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:47,259 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:47,580 - __main__ - INFO -   Iteration 2200: Energy=1.620588e-01
2025-08-18 15:58:47,580 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:47,581 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:47,887 - __main__ - INFO -   Iteration 2250: Energy=1.618671e-01
2025-08-18 15:58:47,887 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:47,888 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:48,180 - __main__ - INFO -   Iteration 2300: Energy=1.617103e-01
2025-08-18 15:58:48,180 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:48,180 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:48,482 - __main__ - INFO -   Iteration 2350: Energy=1.614982e-01
2025-08-18 15:58:48,482 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:48,482 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:48,782 - __main__ - INFO -   Iteration 2400: Energy=1.613290e-01
2025-08-18 15:58:48,782 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:48,782 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:49,085 - __main__ - INFO -   Iteration 2450: Energy=1.611401e-01
2025-08-18 15:58:49,085 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:49,086 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:49,386 - __main__ - INFO -   Iteration 2500: Energy=1.610238e-01
2025-08-18 15:58:49,386 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:49,386 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:49,687 - __main__ - INFO -   Iteration 2550: Energy=1.609243e-01
2025-08-18 15:58:49,687 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 15:58:49,687 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 15:58:49,907 - __main__ - INFO - Refinement triggered at iteration 2586
2025-08-18 15:58:50,106 - __main__ - INFO - Refinement triggered early at level 1
2025-08-18 15:58:50,118 - __main__ - INFO - Results for level 1:
2025-08-18 15:58:50,118 - __main__ - INFO -   Energy: 1.608991e-01
2025-08-18 15:58:50,118 - __main__ - INFO -   Iterations: 2587
2025-08-18 15:58:50,119 - __main__ - INFO -   Time: 13.16s
2025-08-18 15:58:50,119 - __main__ - INFO -   Success: False
2025-08-18 15:58:50,154 - __main__ - INFO - Refinement Summary:
2025-08-18 15:58:50,154 - __main__ - INFO - ================================================================================
2025-08-18 15:58:50,155 - __main__ - INFO -  Level    Mesh Size       Energy Iterations   Time (s)
2025-08-18 15:58:50,155 - __main__ - INFO - --------------------------------------------------------------------------------
2025-08-18 15:58:50,155 - __main__ - INFO -      1       50x50 1.608991e-01       2587      13.16
2025-08-18 15:58:50,155 - __main__ - INFO - ✅ Solution file saved: results/run_20250818_155836_surfring_npart2_v1nr50_v2na50_lam0.0_seed42/surface_part2_surfring_v1nr50_v2na50_lam0.0_seed42_20250818_155836.h5
