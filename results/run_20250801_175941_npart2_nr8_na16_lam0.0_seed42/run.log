2025-08-01 17:59:41,242 - __main__ - INFO - Starting ring partition optimization with 1 refinement levels
2025-08-01 17:59:41,243 - __main__ - INFO - Results will be saved in: results/run_20250801_175941_npart2_nr8_na16_lam0.0_seed42
2025-08-01 17:59:41,243 - __main__ - INFO - ================================================================================
2025-08-01 17:59:41,243 - __main__ - INFO - Refinement Level 1/1
2025-08-01 17:59:41,243 - __main__ - INFO - ================================================================================
2025-08-01 17:59:41,243 - __main__ - INFO - Creating mesh with parameters: {'n_radial': 8, 'n_angular': 16, 'r_inner': 0.5, 'r_outer': 1.0}
2025-08-01 17:59:41,243 - ring_mesh - INFO - Creating ring mesh: n_radial=8, n_angular=16, r_inner=0.5, r_outer=1.0
2025-08-01 17:59:41,259 - ring_mesh - INFO - Mesh created: 128 vertices, 224 triangles
2025-08-01 17:59:41,259 - ring_mesh - INFO - Theoretical area: 2.356194
2025-08-01 17:59:41,259 - __main__ - INFO - Mesh created: 128 vertices, 224 triangles
2025-08-01 17:59:41,259 - __main__ - INFO - Computing FEM matrices...
2025-08-01 17:59:41,286 - ring_mesh - INFO - Starting matrix computation
2025-08-01 17:59:41,287 - ring_mesh - INFO - Starting matrix computation...
2025-08-01 17:59:41,493 - ring_mesh - INFO - Matrix computation completed: Mass matrix (128, 128), Stiffness matrix (128, 128)
2025-08-01 17:59:41,494 - ring_mesh - INFO - matrix computation completed: 0.207s, memory: 0.23MB
2025-08-01 17:59:41,494 - __main__ - INFO - Matrices computed successfully
2025-08-01 17:59:41,495 - ring_mesh - INFO - Mesh statistics: 128 vertices, 224 triangles, area=2.296101
2025-08-01 17:59:41,495 - __main__ - INFO - Setting epsilon to sqrt(mean_triangle_area): 1.012445e-01
2025-08-01 17:59:41,496 - pyslsqp_optimizer - INFO - PySLSQPOptimizer initialized:
2025-08-01 17:59:41,496 - pyslsqp_optimizer - INFO -   Ring: r_inner=0.500, r_outer=1.000
2025-08-01 17:59:41,496 - pyslsqp_optimizer - INFO -   Partitions: 2
2025-08-01 17:59:41,496 - pyslsqp_optimizer - INFO -   Epsilon: 1.01e-01
2025-08-01 17:59:41,496 - pyslsqp_optimizer - INFO -   Theoretical area: 2.356194
2025-08-01 17:59:41,496 - pyslsqp_optimizer - INFO -   Discretized area: 2.296101
2025-08-01 17:59:41,496 - __main__ - INFO - PySLSQP optimizer created
2025-08-01 17:59:41,497 - __main__ - INFO - Creating random initial condition using orthogonal projection
2025-08-01 17:59:41,499 - projection_iterative - INFO - Creating initial condition: 128x2, method=iterative
2025-08-01 17:59:41,500 - projection_iterative - INFO - Projection converged after 1 iterations
2025-08-01 17:59:41,501 - projection_iterative - INFO - Final errors: row=1.08e-10, area=1.00e-10
2025-08-01 17:59:41,501 - __main__ - INFO - Initial condition validation passed
2025-08-01 17:59:41,502 - __main__ - INFO - Checking analytic vs finite-difference gradients...
2025-08-01 17:59:41,502 - __main__ - INFO - Checking analytic vs finite-difference gradients...
2025-08-01 17:59:41,705 - __main__ - WARNING - Large gradient error at point 0: 5.49e-02
2025-08-01 17:59:41,854 - __main__ - WARNING - Large gradient error at point 1: 5.58e-02
2025-08-01 17:59:42,010 - __main__ - WARNING - Large gradient error at point 2: 5.53e-02
2025-08-01 17:59:42,148 - __main__ - WARNING - Large gradient error at point 3: 5.58e-02
2025-08-01 17:59:42,277 - __main__ - WARNING - Large gradient error at point 4: 5.52e-02
2025-08-01 17:59:42,429 - __main__ - WARNING - Large gradient error at point 5: 5.59e-02
2025-08-01 17:59:42,558 - __main__ - WARNING - Large gradient error at point 6: 5.58e-02
2025-08-01 17:59:42,650 - __main__ - WARNING - Large gradient error at point 7: 5.57e-02
2025-08-01 17:59:42,738 - __main__ - WARNING - Large gradient error at point 8: 5.60e-02
2025-08-01 17:59:42,826 - __main__ - WARNING - Large gradient error at point 9: 5.57e-02
2025-08-01 17:59:42,826 - __main__ - INFO - Gradient check completed: avg_error=5.56e-02, max_error=5.60e-02
2025-08-01 17:59:42,826 - __main__ - WARNING - Gradient errors are larger than expected
2025-08-01 17:59:42,827 - pyslsqp_optimizer - INFO - Starting optimization
2025-08-01 17:59:42,827 - pyslsqp_optimizer - INFO - Processing initial condition...
2025-08-01 17:59:42,828 - pyslsqp_optimizer - INFO - ✓ Initial condition processed
2025-08-01 17:59:42,828 - pyslsqp_optimizer - INFO - ✓ Initial condition validation passed
2025-08-01 17:59:42,828 - pyslsqp_optimizer - INFO - Initial state before optimization:
2025-08-01 17:59:42,828 - pyslsqp_optimizer - INFO -   Energy: 1.289236e+01
2025-08-01 17:59:42,828 - pyslsqp_optimizer - INFO -   Initial condition shape: (256,)
2025-08-01 17:59:42,829 - pyslsqp_optimizer - INFO -   Detailed optimization data will be saved to:
2025-08-01 17:59:42,829 - pyslsqp_optimizer - INFO -     Summary: results/run_20250801_175941_npart2_nr8_na16_lam0.0_seed42/pyslsqp_part2_nt8_np16_lam0.0_seed42_level0_summary.out
2025-08-01 17:59:42,829 - pyslsqp_optimizer - INFO -     Internal data: results/run_20250801_175941_npart2_nr8_na16_lam0.0_seed42/pyslsqp_part2_nt8_np16_lam0.0_seed42_level0_internal_data.hdf5
2025-08-01 17:59:42,829 - pyslsqp_optimizer - INFO - Starting PySLSQP optimization with analytic gradients...
2025-08-01 17:59:47,318 - pyslsqp_optimizer - INFO -   Iteration 50:
2025-08-01 17:59:47,318 - pyslsqp_optimizer - INFO -     Energy: 5.640760e+00
2025-08-01 17:59:47,318 - pyslsqp_optimizer - INFO -     Energy change: -2.317512e-02
2025-08-01 17:59:47,318 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 17:59:47,318 - pyslsqp_optimizer - INFO -     Current partition areas: [1.12635738 1.16406207]
2025-08-01 17:59:51,808 - pyslsqp_optimizer - INFO -   Iteration 100:
2025-08-01 17:59:51,808 - pyslsqp_optimizer - INFO -     Energy: 5.811773e+00
2025-08-01 17:59:51,809 - pyslsqp_optimizer - INFO -     Energy change: 6.209253e-03
2025-08-01 17:59:51,809 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 17:59:51,809 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11881422 1.17094461]
2025-08-01 17:59:56,369 - pyslsqp_optimizer - INFO -   Iteration 150:
2025-08-01 17:59:56,369 - pyslsqp_optimizer - INFO -     Energy: 5.840653e+00
2025-08-01 17:59:56,369 - pyslsqp_optimizer - INFO -     Energy change: 3.253963e-02
2025-08-01 17:59:56,369 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 17:59:56,369 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11769102 1.17183111]
2025-08-01 18:00:01,116 - pyslsqp_optimizer - INFO -   Iteration 200:
2025-08-01 18:00:01,116 - pyslsqp_optimizer - INFO -     Energy: 5.821611e+00
2025-08-01 18:00:01,116 - pyslsqp_optimizer - INFO -     Energy change: -6.487921e-03
2025-08-01 18:00:01,117 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:01,117 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11699507 1.17251296]
2025-08-01 18:00:05,525 - pyslsqp_optimizer - INFO -   Iteration 250:
2025-08-01 18:00:05,525 - pyslsqp_optimizer - INFO -     Energy: 5.835406e+00
2025-08-01 18:00:05,525 - pyslsqp_optimizer - INFO -     Energy change: 2.049353e-03
2025-08-01 18:00:05,525 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:05,525 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11655175 1.17295377]
2025-08-01 18:00:09,854 - pyslsqp_optimizer - INFO -   Iteration 300:
2025-08-01 18:00:09,854 - pyslsqp_optimizer - INFO -     Energy: 5.840472e+00
2025-08-01 18:00:09,854 - pyslsqp_optimizer - INFO -     Energy change: 2.426057e-03
2025-08-01 18:00:09,855 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:09,855 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11630214 1.17318697]
2025-08-01 18:00:14,075 - pyslsqp_optimizer - INFO -   Iteration 350:
2025-08-01 18:00:14,075 - pyslsqp_optimizer - INFO -     Energy: 5.839807e+00
2025-08-01 18:00:14,075 - pyslsqp_optimizer - INFO -     Energy change: 7.991574e-05
2025-08-01 18:00:14,075 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:14,075 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11613664 1.17320821]
2025-08-01 18:00:18,674 - pyslsqp_optimizer - INFO -   Iteration 400:
2025-08-01 18:00:18,674 - pyslsqp_optimizer - INFO -     Energy: 5.840575e+00
2025-08-01 18:00:18,674 - pyslsqp_optimizer - INFO -     Energy change: -1.246368e-03
2025-08-01 18:00:18,674 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:18,675 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11604065 1.17329664]
2025-08-01 18:00:24,064 - pyslsqp_optimizer - INFO -   Iteration 450:
2025-08-01 18:00:24,065 - pyslsqp_optimizer - INFO -     Energy: 5.843905e+00
2025-08-01 18:00:24,065 - pyslsqp_optimizer - INFO -     Energy change: 1.059116e-03
2025-08-01 18:00:24,065 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:24,065 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11588874 1.17338398]
2025-08-01 18:00:29,218 - pyslsqp_optimizer - INFO -   Iteration 500:
2025-08-01 18:00:29,219 - pyslsqp_optimizer - INFO -     Energy: 5.846284e+00
2025-08-01 18:00:29,219 - pyslsqp_optimizer - INFO -     Energy change: 2.298416e-03
2025-08-01 18:00:29,219 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:29,219 - pyslsqp_optimizer - INFO -     Current partition areas: [1.1157803  1.17346508]
2025-08-01 18:00:34,178 - pyslsqp_optimizer - INFO -   Iteration 550:
2025-08-01 18:00:34,178 - pyslsqp_optimizer - INFO -     Energy: 5.844788e+00
2025-08-01 18:00:34,178 - pyslsqp_optimizer - INFO -     Energy change: -2.855046e-03
2025-08-01 18:00:34,178 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:34,178 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11570531 1.17346652]
2025-08-01 18:00:38,606 - pyslsqp_optimizer - INFO -   Iteration 600:
2025-08-01 18:00:38,606 - pyslsqp_optimizer - INFO -     Energy: 5.847091e+00
2025-08-01 18:00:38,606 - pyslsqp_optimizer - INFO -     Energy change: -7.490088e-04
2025-08-01 18:00:38,606 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:38,607 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11561701 1.17352624]
2025-08-01 18:00:43,367 - pyslsqp_optimizer - INFO -   Iteration 650:
2025-08-01 18:00:43,367 - pyslsqp_optimizer - INFO -     Energy: 5.848840e+00
2025-08-01 18:00:43,368 - pyslsqp_optimizer - INFO -     Energy change: 5.277608e-04
2025-08-01 18:00:43,368 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:43,368 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11552082 1.17356601]
2025-08-01 18:00:47,771 - pyslsqp_optimizer - INFO -   Iteration 700:
2025-08-01 18:00:47,771 - pyslsqp_optimizer - INFO -     Energy: 5.849655e+00
2025-08-01 18:00:47,771 - pyslsqp_optimizer - INFO -     Energy change: -4.619293e-04
2025-08-01 18:00:47,771 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:47,772 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11545282 1.17359421]
2025-08-01 18:00:52,279 - pyslsqp_optimizer - INFO -   Iteration 750:
2025-08-01 18:00:52,279 - pyslsqp_optimizer - INFO -     Energy: 5.849934e+00
2025-08-01 18:00:52,279 - pyslsqp_optimizer - INFO -     Energy change: -1.598481e-03
2025-08-01 18:00:52,279 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:52,279 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11540479 1.17362882]
2025-08-01 18:00:56,775 - pyslsqp_optimizer - INFO -   Iteration 800:
2025-08-01 18:00:56,775 - pyslsqp_optimizer - INFO -     Energy: 5.851191e+00
2025-08-01 18:00:56,775 - pyslsqp_optimizer - INFO -     Energy change: -7.950021e-04
2025-08-01 18:00:56,775 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:00:56,775 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11533801 1.17366256]
2025-08-01 18:01:01,530 - pyslsqp_optimizer - INFO -   Iteration 850:
2025-08-01 18:01:01,532 - pyslsqp_optimizer - INFO -     Energy: 5.852291e+00
2025-08-01 18:01:01,533 - pyslsqp_optimizer - INFO -     Energy change: -2.545046e-04
2025-08-01 18:01:01,533 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:01:01,533 - pyslsqp_optimizer - INFO -     Current partition areas: [1.1152777  1.17369027]
2025-08-01 18:01:05,913 - pyslsqp_optimizer - INFO -   Iteration 900:
2025-08-01 18:01:05,914 - pyslsqp_optimizer - INFO -     Energy: 5.853165e+00
2025-08-01 18:01:05,914 - pyslsqp_optimizer - INFO -     Energy change: -7.058872e-05
2025-08-01 18:01:05,914 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:01:05,914 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11522472 1.1737135 ]
2025-08-01 18:01:10,273 - pyslsqp_optimizer - INFO -   Iteration 950:
2025-08-01 18:01:10,273 - pyslsqp_optimizer - INFO -     Energy: 5.853923e+00
2025-08-01 18:01:10,273 - pyslsqp_optimizer - INFO -     Energy change: -1.287636e-05
2025-08-01 18:01:10,273 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:01:10,273 - pyslsqp_optimizer - INFO -     Current partition areas: [1.11517626 1.17373403]
2025-08-01 18:01:14,492 - pyslsqp_optimizer - INFO -   Iteration 1000:
2025-08-01 18:01:14,492 - pyslsqp_optimizer - INFO -     Energy: 5.345323e+00
2025-08-01 18:01:14,492 - pyslsqp_optimizer - INFO -     Energy change: -5.092853e-01
2025-08-01 18:01:14,492 - pyslsqp_optimizer - INFO -     Theoretical target area per partition: 1.178097e+00
2025-08-01 18:01:14,492 - pyslsqp_optimizer - INFO -     Current partition areas: [1.14218512 1.14925383]
2025-08-01 18:01:14,651 - pyslsqp_optimizer - INFO - PySLSQP optimization completed:
2025-08-01 18:01:14,651 - pyslsqp_optimizer - INFO -   Success: False
2025-08-01 18:01:14,651 - pyslsqp_optimizer - INFO -   Summary saved to: results/run_20250801_175941_npart2_nr8_na16_lam0.0_seed42/pyslsqp_part2_nt8_np16_lam0.0_seed42_level0_summary.out
2025-08-01 18:01:14,651 - pyslsqp_optimizer - INFO -   Internal data saved to: results/run_20250801_175941_npart2_nr8_na16_lam0.0_seed42/pyslsqp_part2_nt8_np16_lam0.0_seed42_level0_internal_data.hdf5
2025-08-01 18:01:14,651 - pyslsqp_optimizer - WARNING - Returning last valid iterate before unsuccessful termination.
2025-08-01 18:01:14,652 - pyslsqp_optimizer - INFO - optimization completed: 91.825s, memory: 34.21MB
2025-08-01 18:01:14,652 - __main__ - INFO - Results for level 1:
2025-08-01 18:01:14,652 - __main__ - INFO -   Energy: 5.854609e+00
2025-08-01 18:01:14,652 - __main__ - INFO -   Iterations: 1000
2025-08-01 18:01:14,652 - __main__ - INFO -   Time: 91.83s
2025-08-01 18:01:14,652 - __main__ - INFO -   Success: False
2025-08-01 18:01:14,652 - __main__ - INFO - Refinement Summary:
2025-08-01 18:01:14,653 - __main__ - INFO - ================================================================================
2025-08-01 18:01:14,653 - __main__ - INFO -  Level    Mesh Size       Energy Iterations   Time (s)
2025-08-01 18:01:14,653 - __main__ - INFO - --------------------------------------------------------------------------------
2025-08-01 18:01:14,653 - __main__ - INFO -      1         8x16 5.854609e+00       1000      91.83
2025-08-01 18:01:14,655 - __main__ - INFO - ✅ Solution file saved: results/run_20250801_175941_npart2_nr8_na16_lam0.0_seed42/ring_part2_nr8_na16_lam0.0_seed42_20250801_175941.h5
