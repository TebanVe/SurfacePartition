2025-08-18 16:13:59,574 - __main__ - INFO - Starting surface partition optimization with 1 refinement levels
2025-08-18 16:13:59,574 - __main__ - INFO - ================================================================================
2025-08-18 16:13:59,574 - __main__ - INFO - Refinement Level 1/1
2025-08-18 16:13:59,574 - __main__ - INFO - ================================================================================
2025-08-18 16:13:59,574 - surfaces.ring - INFO - Building ring TriMesh: nr=50, na=50, r_in=0.5, r_out=1.0
2025-08-18 16:13:59,600 - core.tri_mesh - INFO - Starting matrix computation
2025-08-18 16:14:00,263 - core.tri_mesh - INFO - Matrix computation completed: M (2500, 2500), K (2500, 2500)
2025-08-18 16:14:00,264 - core.tri_mesh - INFO - matrix computation completed: 0.665s, memory: 2.02MB
2025-08-18 16:14:00,297 - __main__ - INFO - epsilon set to sqrt(mean_triangle_area) = 2.190e-02
2025-08-18 16:14:00,349 - projection_iterative - INFO - Creating initial condition: 2500x2, method=iterative
2025-08-18 16:14:00,351 - projection_iterative - INFO - Projection converged after 2 iterations
2025-08-18 16:14:00,351 - projection_iterative - INFO - Final errors: row=9.14e-10, area=1.00e-10
2025-08-18 16:14:00,353 - __main__ - INFO - Starting PGD optimization
2025-08-18 16:14:00,357 - __main__ - INFO -   Iteration 0: Energy=3.555919e+01
2025-08-18 16:14:00,358 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:00,358 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:00,474 - __main__ - INFO -   Iteration 50: Energy=8.714957e-01
2025-08-18 16:14:00,474 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:00,474 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:00,582 - __main__ - INFO -   Iteration 100: Energy=8.175308e-01
2025-08-18 16:14:00,583 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:00,583 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:00,686 - __main__ - INFO -   Iteration 150: Energy=7.660634e-01
2025-08-18 16:14:00,686 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:00,686 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:00,790 - __main__ - INFO -   Iteration 200: Energy=6.966503e-01
2025-08-18 16:14:00,790 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:00,791 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:00,896 - __main__ - INFO -   Iteration 250: Energy=6.060443e-01
2025-08-18 16:14:00,896 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:00,897 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,005 - __main__ - INFO -   Iteration 300: Energy=5.144810e-01
2025-08-18 16:14:01,005 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,006 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,123 - __main__ - INFO -   Iteration 350: Energy=4.362186e-01
2025-08-18 16:14:01,123 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,124 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,238 - __main__ - INFO -   Iteration 400: Energy=3.751991e-01
2025-08-18 16:14:01,238 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,238 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,352 - __main__ - INFO -   Iteration 450: Energy=3.331971e-01
2025-08-18 16:14:01,352 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,352 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,458 - __main__ - INFO -   Iteration 500: Energy=3.063281e-01
2025-08-18 16:14:01,458 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,458 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,578 - __main__ - INFO -   Iteration 550: Energy=2.835469e-01
2025-08-18 16:14:01,578 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,578 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,691 - __main__ - INFO -   Iteration 600: Energy=2.629151e-01
2025-08-18 16:14:01,692 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,692 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,806 - __main__ - INFO -   Iteration 650: Energy=2.431391e-01
2025-08-18 16:14:01,806 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,806 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:01,920 - __main__ - INFO -   Iteration 700: Energy=2.256477e-01
2025-08-18 16:14:01,920 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:01,920 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:02,047 - __main__ - INFO -   Iteration 750: Energy=2.091627e-01
2025-08-18 16:14:02,047 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:02,047 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:02,168 - __main__ - INFO -   Iteration 800: Energy=1.946670e-01
2025-08-18 16:14:02,168 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:02,168 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:02,302 - __main__ - INFO -   Iteration 850: Energy=1.824711e-01
2025-08-18 16:14:02,302 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:02,302 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:02,456 - __main__ - INFO -   Iteration 900: Energy=1.748724e-01
2025-08-18 16:14:02,456 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:02,456 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:02,670 - __main__ - INFO -   Iteration 950: Energy=1.705954e-01
2025-08-18 16:14:02,670 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:02,670 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:02,910 - __main__ - INFO -   Iteration 1000: Energy=1.684484e-01
2025-08-18 16:14:02,910 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:02,910 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:03,171 - __main__ - INFO -   Iteration 1050: Energy=1.668484e-01
2025-08-18 16:14:03,171 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:03,171 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:03,451 - __main__ - INFO -   Iteration 1100: Energy=1.659794e-01
2025-08-18 16:14:03,451 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:03,451 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:03,755 - __main__ - INFO -   Iteration 1150: Energy=1.652363e-01
2025-08-18 16:14:03,755 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:03,755 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:04,080 - __main__ - INFO -   Iteration 1200: Energy=1.648574e-01
2025-08-18 16:14:04,080 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:04,081 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:04,403 - __main__ - INFO -   Iteration 1250: Energy=1.646057e-01
2025-08-18 16:14:04,404 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:04,404 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:04,736 - __main__ - INFO -   Iteration 1300: Energy=1.644046e-01
2025-08-18 16:14:04,736 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:04,736 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:05,061 - __main__ - INFO -   Iteration 1350: Energy=1.642260e-01
2025-08-18 16:14:05,061 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:05,061 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:05,394 - __main__ - INFO -   Iteration 1400: Energy=1.640569e-01
2025-08-18 16:14:05,394 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:05,394 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:05,725 - __main__ - INFO -   Iteration 1450: Energy=1.638979e-01
2025-08-18 16:14:05,725 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:05,725 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:06,058 - __main__ - INFO -   Iteration 1500: Energy=1.637468e-01
2025-08-18 16:14:06,058 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:06,058 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:06,384 - __main__ - INFO -   Iteration 1550: Energy=1.636063e-01
2025-08-18 16:14:06,384 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:06,384 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:06,715 - __main__ - INFO -   Iteration 1600: Energy=1.634734e-01
2025-08-18 16:14:06,715 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:06,715 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:07,039 - __main__ - INFO -   Iteration 1650: Energy=1.633492e-01
2025-08-18 16:14:07,039 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:07,039 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:07,371 - __main__ - INFO -   Iteration 1700: Energy=1.632303e-01
2025-08-18 16:14:07,371 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:07,371 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:07,704 - __main__ - INFO -   Iteration 1750: Energy=1.631172e-01
2025-08-18 16:14:07,704 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:07,704 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:08,051 - __main__ - INFO -   Iteration 1800: Energy=1.630065e-01
2025-08-18 16:14:08,051 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:08,052 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:08,399 - __main__ - INFO -   Iteration 1850: Energy=1.628982e-01
2025-08-18 16:14:08,399 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:08,399 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:08,735 - __main__ - INFO -   Iteration 1900: Energy=1.627893e-01
2025-08-18 16:14:08,736 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:08,736 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:09,064 - __main__ - INFO -   Iteration 1950: Energy=1.626794e-01
2025-08-18 16:14:09,064 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:09,064 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:09,401 - __main__ - INFO -   Iteration 2000: Energy=1.625657e-01
2025-08-18 16:14:09,401 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:09,402 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:09,728 - __main__ - INFO -   Iteration 2050: Energy=1.624467e-01
2025-08-18 16:14:09,728 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:09,729 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:10,053 - __main__ - INFO -   Iteration 2100: Energy=1.623507e-01
2025-08-18 16:14:10,053 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:10,054 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:10,393 - __main__ - INFO -   Iteration 2150: Energy=1.621823e-01
2025-08-18 16:14:10,393 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:10,393 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:10,754 - __main__ - INFO -   Iteration 2200: Energy=1.620588e-01
2025-08-18 16:14:10,754 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:10,755 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:11,070 - __main__ - INFO -   Iteration 2250: Energy=1.618671e-01
2025-08-18 16:14:11,070 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:11,071 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:11,377 - __main__ - INFO -   Iteration 2300: Energy=1.617103e-01
2025-08-18 16:14:11,377 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:11,377 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:11,689 - __main__ - INFO -   Iteration 2350: Energy=1.614982e-01
2025-08-18 16:14:11,689 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:11,689 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:11,999 - __main__ - INFO -   Iteration 2400: Energy=1.613290e-01
2025-08-18 16:14:12,000 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:12,000 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:12,305 - __main__ - INFO -   Iteration 2450: Energy=1.611401e-01
2025-08-18 16:14:12,305 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:12,305 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:12,606 - __main__ - INFO -   Iteration 2500: Energy=1.610238e-01
2025-08-18 16:14:12,606 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:12,607 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:12,916 - __main__ - INFO -   Iteration 2550: Energy=1.609243e-01
2025-08-18 16:14:12,916 - __main__ - INFO -     Target area per partition: 1.174999e+00
2025-08-18 16:14:12,916 - __main__ - INFO -     Current partition areas: [1.17499906 1.17499906]
2025-08-18 16:14:13,134 - __main__ - INFO - Refinement triggered at iteration 2586
2025-08-18 16:14:13,239 - __main__ - INFO - Refinement triggered early at level 1
2025-08-18 16:14:13,252 - __main__ - INFO - Results for level 1:
2025-08-18 16:14:13,252 - __main__ - INFO -   Energy: 1.608991e-01
2025-08-18 16:14:13,252 - __main__ - INFO -   Iterations: 2587
2025-08-18 16:14:13,252 - __main__ - INFO -   Time: 12.89s
2025-08-18 16:14:13,252 - __main__ - INFO -   Success: False
2025-08-18 16:14:13,292 - __main__ - INFO - Refinement Summary:
2025-08-18 16:14:13,292 - __main__ - INFO - ================================================================================
2025-08-18 16:14:13,293 - __main__ - INFO -  Level    Mesh Size       Energy Iterations   Time (s)
2025-08-18 16:14:13,293 - __main__ - INFO - --------------------------------------------------------------------------------
2025-08-18 16:14:13,293 - __main__ - INFO -      1       50x50 1.608991e-01       2587      12.89
2025-08-18 16:14:13,293 - __main__ - INFO - ✅ Solution file saved: results/run_20250818_161359_surfring_npart2_v1nr50_v2na50_lam0.0_seed42/surface_part2_surfring_v1nr50_v2na50_lam0.0_seed42_20250818_161359.h5
