2025-08-18 14:06:09,862 - __main__ - INFO - Starting surface partition optimization with 2 refinement levels
2025-08-18 14:06:09,862 - __main__ - INFO - ================================================================================
2025-08-18 14:06:09,862 - __main__ - INFO - Refinement Level 1/2
2025-08-18 14:06:09,862 - __main__ - INFO - ================================================================================
2025-08-18 14:06:09,862 - surfaces.ring - INFO - Building ring TriMesh: nr=24, na=24, r_in=0.5, r_out=1.0
2025-08-18 14:06:09,881 - core.tri_mesh - INFO - Starting matrix computation
2025-08-18 14:06:10,035 - core.tri_mesh - INFO - Matrix computation completed: M (576, 576), K (576, 576)
2025-08-18 14:06:10,036 - core.tri_mesh - INFO - matrix computation completed: 0.155s, memory: 0.96MB
2025-08-18 14:06:10,037 - __main__ - INFO - epsilon set to sqrt(mean_triangle_area) = 4.593e-02
2025-08-18 14:06:10,038 - projection_iterative - INFO - Creating initial condition: 576x2, method=iterative
2025-08-18 14:06:10,039 - projection_iterative - INFO - Projection converged after 3 iterations
2025-08-18 14:06:10,039 - projection_iterative - INFO - Final errors: row=3.85e-09, area=1.00e-10
2025-08-18 14:06:10,040 - __main__ - INFO - Starting PGD optimization
2025-08-18 14:06:10,045 - __main__ - INFO -   Iteration 0: Energy=1.560308e+01
2025-08-18 14:06:10,045 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,045 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,161 - __main__ - INFO -   Iteration 50: Energy=4.617107e+00
2025-08-18 14:06:10,161 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,161 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,262 - __main__ - INFO -   Iteration 100: Energy=3.990128e-01
2025-08-18 14:06:10,262 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,262 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,363 - __main__ - INFO -   Iteration 150: Energy=3.785347e-01
2025-08-18 14:06:10,363 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,363 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,459 - __main__ - INFO -   Iteration 200: Energy=3.487678e-01
2025-08-18 14:06:10,459 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,459 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,558 - __main__ - INFO -   Iteration 250: Energy=3.133829e-01
2025-08-18 14:06:10,558 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,558 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,659 - __main__ - INFO -   Iteration 300: Energy=2.911009e-01
2025-08-18 14:06:10,659 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,660 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:10,756 - __main__ - INFO -   Iteration 350: Energy=2.648231e-01
2025-08-18 14:06:10,756 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:10,756 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:11,331 - __main__ - INFO -   Iteration 400: Energy=2.619180e-01
2025-08-18 14:06:11,331 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:11,331 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:12,233 - __main__ - INFO -   Iteration 450: Energy=2.619180e-01
2025-08-18 14:06:12,233 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:12,233 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:13,115 - __main__ - INFO -   Iteration 500: Energy=2.619180e-01
2025-08-18 14:06:13,115 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:13,116 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:13,996 - __main__ - INFO -   Iteration 550: Energy=2.619180e-01
2025-08-18 14:06:13,996 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:13,996 - __main__ - INFO -     Current partition areas: [1.1646857 1.1646857]
2025-08-18 14:06:14,876 - __main__ - INFO - PGD optimization completed: Success=True
2025-08-18 14:06:14,876 - __main__ - INFO -   Summary saved to: results/run_20250818_140609_surfring_npart2_v1nr24-29_incr5_v2na24-29_incr5_lam0.0_seed42/pgd_part2_v1nr24_v2na24_level0_summary.out
2025-08-18 14:06:14,876 - __main__ - INFO -   Internal data saved to: results/run_20250818_140609_surfring_npart2_v1nr24-29_incr5_v2na24-29_incr5_lam0.0_seed42/pgd_part2_v1nr24_v2na24_level0_internal_data.hdf5
2025-08-18 14:06:14,876 - __main__ - INFO -   optimization completed: 4.835s
2025-08-18 14:06:14,876 - __main__ - INFO - Results for level 1:
2025-08-18 14:06:14,876 - __main__ - INFO -   Energy: 2.619180e-01
2025-08-18 14:06:14,877 - __main__ - INFO -   Iterations: 600
2025-08-18 14:06:14,877 - __main__ - INFO -   Time: 4.84s
2025-08-18 14:06:14,877 - __main__ - INFO -   Success: True
2025-08-18 14:06:14,877 - __main__ - INFO - ================================================================================
2025-08-18 14:06:14,877 - __main__ - INFO - Refinement Level 2/2
2025-08-18 14:06:14,877 - __main__ - INFO - ================================================================================
2025-08-18 14:06:14,877 - surfaces.ring - INFO - Building ring TriMesh: nr=29, na=29, r_in=0.5, r_out=1.0
2025-08-18 14:06:14,880 - core.tri_mesh - INFO - Starting matrix computation
2025-08-18 14:06:15,098 - core.tri_mesh - INFO - Matrix computation completed: M (841, 841), K (841, 841)
2025-08-18 14:06:15,098 - core.tri_mesh - INFO - matrix computation completed: 0.218s, memory: 0.29MB
2025-08-18 14:06:15,101 - __main__ - INFO - epsilon set to sqrt(mean_triangle_area) = 3.794e-02
2025-08-18 14:06:15,125 - projection_iterative - INFO - Projection converged after 1 iterations
2025-08-18 14:06:15,126 - projection_iterative - INFO - Final errors: row=3.35e-10, area=1.00e-10
2025-08-18 14:06:15,126 - __main__ - INFO - Starting PGD optimization
2025-08-18 14:06:15,129 - __main__ - INFO -   Iteration 0: Energy=2.895745e-01
2025-08-18 14:06:15,129 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:15,129 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:15,219 - __main__ - INFO -   Iteration 50: Energy=2.710444e-01
2025-08-18 14:06:15,219 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:15,219 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:16,128 - __main__ - INFO -   Iteration 100: Energy=2.709798e-01
2025-08-18 14:06:16,129 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:16,129 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:17,131 - __main__ - INFO -   Iteration 150: Energy=2.709798e-01
2025-08-18 14:06:17,131 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:17,132 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:18,118 - __main__ - INFO -   Iteration 200: Energy=2.709798e-01
2025-08-18 14:06:18,118 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:18,119 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:19,122 - __main__ - INFO -   Iteration 250: Energy=2.709798e-01
2025-08-18 14:06:19,122 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:19,122 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:20,120 - __main__ - INFO -   Iteration 300: Energy=2.709798e-01
2025-08-18 14:06:20,120 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:20,121 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:21,107 - __main__ - INFO -   Iteration 350: Energy=2.709798e-01
2025-08-18 14:06:21,107 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:21,108 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:22,114 - __main__ - INFO -   Iteration 400: Energy=2.709798e-01
2025-08-18 14:06:22,115 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:22,115 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:23,114 - __main__ - INFO -   Iteration 450: Energy=2.709798e-01
2025-08-18 14:06:23,114 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:23,115 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:24,117 - __main__ - INFO -   Iteration 500: Energy=2.709798e-01
2025-08-18 14:06:24,117 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:24,118 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:25,147 - __main__ - INFO -   Iteration 550: Energy=2.709798e-01
2025-08-18 14:06:25,147 - __main__ - INFO -     Target area per partition: 1.178097e+00
2025-08-18 14:06:25,148 - __main__ - INFO -     Current partition areas: [1.16890177 1.16890177]
2025-08-18 14:06:26,152 - __main__ - INFO - PGD optimization completed: Success=True
2025-08-18 14:06:26,152 - __main__ - INFO -   Summary saved to: results/run_20250818_140609_surfring_npart2_v1nr24-29_incr5_v2na24-29_incr5_lam0.0_seed42/pgd_part2_v1nr29_v2na29_level1_summary.out
2025-08-18 14:06:26,152 - __main__ - INFO -   Internal data saved to: results/run_20250818_140609_surfring_npart2_v1nr24-29_incr5_v2na24-29_incr5_lam0.0_seed42/pgd_part2_v1nr29_v2na29_level1_internal_data.hdf5
2025-08-18 14:06:26,152 - __main__ - INFO -   optimization completed: 11.025s
2025-08-18 14:06:26,153 - __main__ - INFO - Results for level 2:
2025-08-18 14:06:26,153 - __main__ - INFO -   Energy: 2.709798e-01
2025-08-18 14:06:26,153 - __main__ - INFO -   Iterations: 600
2025-08-18 14:06:26,153 - __main__ - INFO -   Time: 11.03s
2025-08-18 14:06:26,153 - __main__ - INFO -   Success: True
2025-08-18 14:06:26,174 - __main__ - INFO - Refinement Summary:
2025-08-18 14:06:26,174 - __main__ - INFO - ================================================================================
2025-08-18 14:06:26,174 - __main__ - INFO -  Level    Mesh Size       Energy Iterations   Time (s)
2025-08-18 14:06:26,174 - __main__ - INFO - --------------------------------------------------------------------------------
2025-08-18 14:06:26,174 - __main__ - INFO -      1       24x24 2.619180e-01        600       4.84
2025-08-18 14:06:26,175 - __main__ - INFO -      2       29x29 2.709798e-01        600      11.03
2025-08-18 14:06:26,175 - __main__ - INFO - ✅ Solution file saved: results/run_20250818_140609_surfring_npart2_v1nr24-29_incr5_v2na24-29_incr5_lam0.0_seed42/surface_part2_surfring_v1nr24-29_incr5_v2na24-29_incr5_lam0.0_seed42_20250818_140609.h5
